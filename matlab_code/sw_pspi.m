function spi = sw_pspi(s0,t0,p0,pr)
 
% s0: salinity, in the range of [10:40] (psu)
% t0: in-situ temperature, in the range of [-2:40] (^oC)
% p : in-situe pressure (db)
% pr: reference pressure (db), must be one of the following intergers:
%        0, 500, 1000, 2000, 3000, 4000, 5000 (db)
% Example: sw_pspi(36.0,15.000,0,0)=0.4211 (kg/m^3);
% Author: Rui Xin Huang
% Date: Sep. 28, 2018
 
b0=[-0.0153300841099570,  0.0231895932005821, -0.0381875052767683,...
     0.1592557110880523,  0.0117243711053217, -0.0718653451824515,...
     0.5318847880659945,  0.0779892741936997,  0.0035239803459740,...
     0.1201750871344241,  1.3042441933369422,  0.3565702465910514,...
     0.0369715779948543,  0.0000800204884482, -1.0632874635722567,...
     1.5631387572647097,  0.0089892799984272, -0.2183716842447750,...
    -0.0281177888020686, -0.0013045569983979,  4.2176434025093101,...
     4.6913470773126011,  2.5592069121111529,  2.3758221464778653,...
     0.4911933538650005,  0.0298538964966979,  0.0016225085963151,...
    -9.3974242130945633, -4.3905044464512457,  1.5070608294125327,...
    -5.5501502356153471, -3.2062353090836222, -0.3928957921270134,...
    -0.0316989049793372, -0.0017416060933394, 13.2462318893758850,...
    19.6295852797249890, -3.3083205188612457,  5.8386677663053890,...
     7.1937016736312600,  2.1546104550028686,  0.0996470664237621,...
     0.0297021530229794,  0.0015361697390362, -9.7346615514331560,...
   -18.8955171635407950,  5.9733854291477746,  0.3783949644377257,...
    -5.8999876151527202, -3.8573920011834675, -0.6665314984311493,...
     0.0358514745101728, -0.0172904156245161, -0.0006456633104225,...
     3.5001447334308131, 13.0257424609277040,  1.0828755101246170,...
    -0.4450532843399354,  0.1809352509285085,  2.2432052797602897,...
     0.6072423205728305,  0.1123186585718297, -0.0197441171553408,...
     0.0047837338370827,  0.0001058068718505];
 b500=[-0.0170897680043427,  0.0393980201464236, -0.0322181007256357,...
     0.2465779702237007,  0.0196951777573940, -0.0340256035131898,...
     0.7548983242984324,  0.1209959405758238,  0.0060760492664506,...
     0.1186565896130432,  1.6463999712553303,  0.4709774375654697,...
     0.0526748524725206, -0.0000370598201769, -0.4596327796294014,...
     2.0379216819038586,  0.1518525728129951, -0.1916555843387189,...
    -0.0369618601778135, -0.0017944795273568,  2.3546809284893735,...
     3.8759296980147950,  2.9104105624114198,  2.4389794658940893,...
     0.5032009345452483,  0.0469302584258510,  0.0018343354907595,...
    -4.7626772767589456, -0.4809814106641089,  0.8409503724739962,...
    -5.3772643134946145, -3.2051475990896465, -0.4169693314118330,...
    -0.0603545798915546, -0.0016126506399402,  7.0904800397810774,...
    10.4358091142353400, -1.7098551480956530,  5.5920785736934606,...
     7.0190653686553324,  2.1137399496512042,  0.1209557483696642,...
     0.0567464281690320,  0.0014241231794942, -5.1119719051196704,...
    -8.9361269179306273,  4.4208404799781595,  0.3638415547771647,...
    -5.5795643245841617, -3.8205371549694354, -0.6235916487154449,...
     0.0210332177260958, -0.0298501212939195, -0.0005407915757731,...
     1.9713169360784892,  7.2023488988739333,  0.8751781695325449,...
    -0.5576302851748650,  0.3120792130214046,  2.0030004797305798,...
     0.6781634724458714,  0.0886131123332279, -0.0125258948868738,...
     0.0071733806912177,  0.0000764047696809];
b1000=[-0.0152796296361631,  0.0634840156952664, -0.0134499436502916,...
     0.3629264124823363,  0.0313022734302577,  0.0242237811432335,...
     1.0187474687702429,  0.1773719831098710,  0.0099091613026001,...
     0.1691235290636256,  1.9985805250978699,  0.5994233243005691,...
     0.0730579249356983, -0.0002047748310705, -0.0636584894370516,...
     2.3904585542604715,  0.3293130608600984, -0.1463442323972841,...
    -0.0465947637412494, -0.0027639826215597,  1.3292646659965168,...
     3.4267820352004521,  3.1062630355985164,  2.4107785782524207,...
     0.4993011197582294,  0.0643809383043240,  0.0028493345644662,...
    -2.1625538261755337,  1.4239302709720265,  0.3955622178527191,...
    -5.0171900524765860, -3.0742800375630850, -0.4399256184470501,...
    -0.0898904479010334, -0.0025567347493471,  3.6477127928388744,...
     5.3206703060792782, -0.6919221499024630,  5.2429080677277975,...
     6.5662197491194361,  2.0008960637703823,  0.1506262108518998,...
     0.0841439315207993,  0.0023309531864595, -2.5435478726615646,...
    -3.6853080297903333,  3.3399207041986787,  0.2340886383835905,...
    -5.0938462922172238, -3.6222070014123475, -0.5783801858129577,...
     0.0026567274608136, -0.0420964556511797, -0.0009336622148579,...
     1.0790284792918607,  3.8647869734498403,  0.5916969122340452,...
    -0.5168326465476724,  0.3366904017124426,  1.7730130282701744,...
     0.6905225982068610,  0.0769487350865983, -0.0057920650733116,...
     0.0094835221955953,  0.0001497191916782];
b2000=[0.0091417081396188,  0.1452955939511846,  0.0770118742407799,...
     0.6969572944033762,  0.0689590943556884,  0.2052671884421505,...
     1.6493343937052261,  0.3325382924550207,  0.0232279929569938,...
     0.3549428710544382,  2.6588535884495310,  0.8793293294099017,...
     0.1312861610175250, -0.0013913144468472,  0.3773746884403297,...
     2.8097805261579611,  0.7468352594494717,  0.0054925826410827,...
    -0.0734726572370883, -0.0054221218460469,  0.4925650505594068,...
     2.8949682015867260,  3.0445208914586348,  2.0745903040460929,...
     0.4117184896548931,  0.1122163176449262,  0.0057235041280763,...
     0.0013733957773534,  2.3823825552243458, -0.0525449092789445,...
    -3.8209684066062266, -2.4373733447193815, -0.4279490589511414,...
    -0.1729231959436325, -0.0054925819960008,  0.7046929492037855,...
     0.9344987275258222,  0.2969191013375820,  4.2113960509310218,...
     5.0169760698229204,  1.5324604234032757,  0.1856791756573022,...
     0.1624044356549286,  0.0054301380642790, -0.3968294706581253,...
     0.3054017331910741,  1.9252531003555615, -0.0877226648348107,...
    -3.8257373677218180, -2.8440753233870275, -0.4352813145427408,...
    -0.0234420265213581, -0.0779105435940676, -0.0023438751225325,...
     0.2672395631765803,  0.8666719628347207,  0.0762680268014655,...
    -0.3034474267877694,  0.2563735218432175,  1.3041416229218938,...
     0.5919917285182480,  0.0650718724250279,  0.0034357714409026,...
     0.0166075264216577,  0.0004196791282721];
b3000=[0.0829921187927801,  0.2940570154114436,  0.2578885740581015,...
     1.1894395862680167,  0.1314295760613576,  0.4611757366676674,...
     2.3800776316930210,  0.5404506032664056,  0.0479418747927825,...
     0.5717539343370265,  3.1802290008980481,  1.1532217395761863,...
     0.2188291802224379, -0.0050117634983723,  0.5622738524648018,...
     2.9410140059929866,  1.1894880958689704,  0.2288565966419371,...
    -0.1212819030176276, -0.0100180336081773,  0.2901642712632136,...
     2.4088812196170579,  2.4138569910554297,  1.3292134446557626,...
     0.1974376712015098,  0.1877955201148325,  0.0120583403113963,...
     0.4631123222997070,  1.8683667712558829, -0.1210250841869803,...
    -2.0803807862499175, -1.2636083847943982, -0.3148043221734607,...
    -0.2973971834277590, -0.0127984759544481, -0.0898243185029628,...
    -0.1895452576574909,  0.5950558016225140,  2.7675605470131655,...
     2.7661066543570692,  0.6444098115446179,  0.1834064684876638,...
     0.2771091355143084,  0.0128028706653020,  0.1443158973235865,...
     0.9521965669200102,  0.9250791797991642, -0.3374875218359553,...
    -2.3588120767435465, -1.6314981684460832, -0.1318487241192919,...
    -0.0462475142345925, -0.1293713685555110, -0.0057611757126841,...
     0.0124346887668264, -0.0590204503858635, -0.2102399523640291,...
    -0.1258060204210724,  0.1544912306800221,  0.7994584093319075,...
     0.3694396473607853,  0.0318541718233533,  0.0132853113210982,...
     0.0266429967409608,  0.0010890850132457];
b4000=[0.2370002318651782,  0.5381589430593935,  0.5387332509583285,...
     1.8367328878855200,  0.2190076533245268,  0.7527436638782535,...
     3.1045464711421662,  0.7710129605215795,  0.0894202672607398,...
     0.7482044198379578,  3.4607088826442109,  1.3769400814627872,...
     0.3395747291647098, -0.0144359439344768,  0.5845814889160134,...
     2.7749098715576741,  1.4552709439955931,  0.4077830363517979,...
    -0.2056660897277933, -0.0174856389508560,  0.2872973066717510,...
     1.8522445541076458,  1.5986862566228270,  0.6203915955318132,...
     0.0190869991558108,  0.2957002215280178,  0.0264031095282703,...
     0.3015680656488169,  1.0062127553156917, -0.0100938790000904,...
    -0.6693418077745867, -0.2585731993743720, -0.2467721345005530,...
    -0.4497985949554598, -0.0310783369635849, -0.0886553875979514,...
    -0.0847613325636572,  0.4843116193937502,  1.4496276135138042,...
     0.9628824750866357, -0.1306978534604700,  0.2138998039833219,...
     0.4085072429345181,  0.0302894687290413,  0.1128438575883403,...
     0.4713019340266491,  0.2885042964220720, -0.3231744990167486,...
    -1.2269978401137021, -0.6365606225666358,  0.1550364472972289,...
    -0.0836582108559878, -0.1851024503722259, -0.0140010791448744,...
    -0.0197718505975002, -0.1262118069000105, -0.1611870955479239,...
    -0.0559238641448582,  0.0930198972851187,  0.4090199622334122,...
     0.1744755449159634, -0.0099361780755030,  0.0262336469312906,...
     0.0369115755434412,  0.0027324983705219];
b5000=[0.5137108656598407,  0.9272118361918661,  0.9237574106913609,...
     2.6488771120490111,  0.3203064640437509,  1.0396844175235527,...
     3.7457447497414229,  0.9682339828436751,  0.1598527167686548,...
     0.8449949476579887,  3.4769854850202657,  1.4949967184869493,...
     0.5045073446974311, -0.0450435727340453,  0.5229812333095537,...
     2.3513000303991149,  1.3920139847466240,  0.4511115607461256,...
    -0.3670587255997733, -0.0134242433773768,  0.2558677222788089,...
     1.2471581703858128,  0.9523495152661099,  0.3074440965302491,...
     0.0114939329849617,  0.4812484081251261,  0.0324515116106133,...
     0.1114887314469300,  0.4173385012799878,  0.0228174936852482,...
    -0.0826327488562640,  0.0403434422478097, -0.3518776929784379,...
    -0.6675432305132891, -0.0432864238607635,  0.0016930899000822,...
     0.0437619774486480,  0.2221900544906569,  0.6442939140253805,...
     0.1692791407743907, -0.3308066513013085,  0.3363847718265349,...
     0.5811985675973489,  0.0456362418587216,  0.0207294612505628,...
     0.0781348649106775,  0.0398163605209567, -0.1604848102578897,...
    -0.5895951930360275, -0.1754460644090687,  0.2209529745724252,...
    -0.1407328439846876, -0.2569291682263102, -0.0218758921025089,...
    -0.0047991381246822, -0.0292812892190461, -0.0342521306783400,...
    -0.0216511237754927,  0.0494919851708555,  0.1980313253516407,...
     0.0745912573742710, -0.0211661411562899,  0.0380984000054902,...
     0.0500761805296033,  0.0043823530255001];
IC=0;
if (pr==0),        b=b0;       spi0=3.446776934; IC=1; end
if (pr==500),    b=b500;   spi0=1.705024348; IC=1; end
if (pr==1000),  b=b1000; spi0=1.367927975; IC=1; end
if (pr==2000),  b=b2000; spi0=1.513725542; IC=1; end
if (pr==3000),  b=b3000; spi0=1.916367274; IC=1; end
if (pr==4000),  b=b4000; spi0=2.428307519; IC=1; end
if (pr==5000),  b=b5000; spi0=3.091480510; IC=1; end
if (IC==0), error('Reference pressure incorrect '), end
 
if (s0<10 | s0>40), error('Salinity out of bound'), end
if (t0<-2 | t0>40),  error('Temperature out of bound'), end
    
t00=sw_ptmp(s0,t0,p0,pr);
s=(s0-10)/30;
t=(t00+2)/42;
  s2=s.*s;s3=s2.*s;s4=s3.*s;s5=s4.*s;s6=s5.*s;s7=s6.*s;s8=s7.*s;s9=s8.*s;s10=s9.*s;
  t2=t.*t;t3=t2.*t;t4=t3.*t;t5=t4.*t;t6=t5.*t;t7=t6.*t;t8=t7.*t;t9=t8.*t;t10=t9.*t;
sp=b(1).*s+b(2).*t+b(3).*s2+b(4).*s.*t+b(5).*t2;
sp=sp+b(6).*s3+b(7).*s2.*t+b(8).*s.*t2+b(9).*t3;
sp=sp+b(10).*s4+b(11).*s3.*t+b(12).*s2.*t2+b(13).*s.*t3+b(14).*t4;
sp=sp+b(15).*s5+b(16).*s4.*t+b(17).*s3.*t2+b(18).*s2.*t3+b(19).*s.*t4+b(20).*t5;
sp=sp+b(21).*s6+b(22).*s5.*t+b(23).*s4.*t2+...
    b(24).*s3.*t3+b(25).*s2.*t4+b(26).*s.*t5+b(27).*t6;
sp=sp+b(28).*s7+b(29).*s6.*t+b(30).*s5.*t2+...
    b(31).*s4.*t3+b(32).*s3.*t4+b(33).*s2.*t5+b(34).*s.*t6+b(35).*t7;
sp=sp+b(36).*s8+b(37).*s7.*t+b(38).*s6.*t2+...
    b(39).*s5.*t3+b(40).*s4.*t4+b(41).*s3.*t5+b(42).*s2.*t6+b(43).*s.*t7+b(44).*t8;
sp=sp+b(45).*s9+b(46).*s8.*t+b(47).*s7.*t2+b(48).*s6.*t3+b(49).*s5.*t4+...
    b(50).*s4.*t5+b(51).*s3.*t6+b(52).*s2.*t7+b(53).*s.*t8+b(54).*t9;
sp=sp+b(55).*s10+b(56).*s9.*t+b(57).*s8.*t2+b(58).*s7.*t3+b(59).*s6.*t4+...
    b(60).*s5.*t5+b(61).*s4.*t6+b(62).*s3.*t7+b(63).*s2.*t8+b(64).*s.*t9+b(65).*t10;
spi = sp-spi0;
return

gsw_pspi.m (based on TEOS_10):

function spi = gsw_pspi(SA,CT,pr)
% Potential spicity based on TEOS_10
% SA: Absolute salinity, in the range of [10:40] (g/kg).
% CT: Conservative temperature, in the range of [-2:40] (^oC)
% pr: Reference pressure (db), must be one of the following intergers:
%        0, 500, 1000, 2000, 3000, 4000, 5000 (db)
% Example: gsw_pspi(37.0,15.000,0)=1.3010 (kg/m^3);
% Author: Rui Xin Huang
% Date: Sep. 28, 2018
 
b0=[ -0.0171500663640825,  0.0278126882615466, -0.0377076764387318,...
      0.1766949182578261,  0.0123660614159258, -0.0786187616470358,...
      0.5654881379784148,  0.0819229370724436,  0.0016117501650810,...
      0.3399789798792979,  1.1510501460340983,  0.2269712954132772,...
      0.0034027893357210, -0.0006433028065820, -2.4325213233770255,...
      1.7986328638555464,  1.0630530543043479,  0.1315650249668150,...
      0.0123872288821259, -0.0001162370520279,  9.4412720110135577,...
      5.2288742719111454, -2.0527960573002453, -0.5351256154930265,...
     -0.2538791804144606, -0.0209657872828231,  0.0013762624523221,...
    -20.8951737319684660,-12.0500968552060320, 11.3282734921878920,...
      2.6701702134225695,  0.5047618576788786,  0.4114298464948320,...
      0.0054621969229276, -0.0011544718126917, 27.9102532787346750,...
     38.3524589057019940,-15.7880978505589340, -5.2014100596868458,...
     -1.6444622029678000, -0.1940601182950926, -0.4451390714439674,...
      0.0318285987830426,  0.0002610786604573,-19.9067865528804480,...
    -40.9762890937185630, 14.0378531543133480,  7.5013409290727173,...
      0.6852984398082621,  1.0864034614467579, -0.1443123955763263,...
      0.3116506259221469, -0.0374707683235198,  0.0003602355280168,...
      6.4526166843817130, 23.5603943927535690, -0.1544936317675803,...
     -2.0654213392823562, -2.3484390479461044,  1.2077832413374705,...
     -0.7375977238163819,  0.2037145511491106, -0.1037032514606002,...
      0.0135916525382002, -0.0002031986199229];
b500=[-0.0182391987673546,  0.0460367847358395, -0.0286182192704045,...
       0.2660847104116245,  0.0206673399387414, -0.0298007013259687,...
       0.7770094369066807,  0.1251051429700339,  0.0028476405867851,...
       0.2732186418523409,  1.4034080039262458,  0.3119256718363070,...
       0.0090495634322624, -0.0019995910040957, -1.4285067908881954,...
       2.4382974814612299,  1.3470633754508330,  0.2346478272358809,...
      -0.0024859020619016,  0.0035261905625462,  6.0718169574685028,...
       3.2771054529421333, -2.1234813624271149, -0.8676978602413056,...
      -0.4525801376304305,  0.0302373171446931, -0.0066258727117268,...
     -13.0149881442439100, -4.8980524182905798, 11.2404267704152550,...
       3.6705166907148050,  0.9927811680516538,  0.6597340841418953,...
      -0.0890970730587889,  0.0113440640814710, 17.6138287954952340,...
      23.1042897942189110,-14.0150247189858150, -6.7035271369546621,...
      -2.3493946449434784, -0.6652221178039853, -0.6098849102442132,...
       0.1310559376769550, -0.0113401749308976,-12.4704499840356750,...
     -24.6120143973906740, 11.7844367965431600,  8.6220035582779673,...
       1.5600677522586048,  1.2667953809112951,  0.1662333591001361,...
       0.3575983205997738, -0.0906989152954278,  0.0062620914224265,...
       4.1599595530865345, 15.0628535938609790,  0.2359014673160792,...
      -2.5129596228128590, -2.3628293562073948,  0.7771260421750895,...
      -0.6377943796237359,  0.0934531200410584, -0.1017862844693545,...
       0.0249840213426481, -0.0014670482649370];
b1000=[-0.0150169592493302,  0.0713618996357972, -0.0063107595207969,...
        0.3769874692789238,  0.0323471419293896,  0.0351208366975207,...
        1.0068345758287314,  0.1795605422124667,  0.0046453697978788,...
        0.2660759416082976,  1.6500909237389616,  0.4159308583779059,...
        0.0172494972199483, -0.0037161650590758, -0.7389047240972881,...
        2.8726693927520741,  1.6113998813159669,  0.3263230715734760,...
       -0.0159057725287228,  0.0074942309647332,  3.9264795079017127,...
        2.0179651645749908, -2.1175594837314753, -1.1469107615651093,...
       -0.6074186313683612,  0.0677203517868007, -0.0143769224106303,...
       -8.0548342124827972, -0.5928438573972383, 11.0255586363736220,...
        4.4397150056556818,  1.4442136322713750,  0.8260715519198784,...
       -0.1506947213105953,  0.0229660159301995, 11.1990826198239940,...
       13.6095051050301340,-12.6310176774328490, -7.6517232263421988,...
       -2.9693324389401625, -1.1000629722739033, -0.6881119910562087,...
        0.1921672059589442, -0.0217714705421179, -7.8758049022617191,...
      -14.6605730305262480, 10.1796178565571620,  9.1511612055300944,...
        2.2872279620162583,  1.4537424541706934,  0.4416488901443254,...
        0.3576765139643476, -0.1214552440110710,  0.0114134836142687,...
        2.7139348361455027,  9.7516625559981929,  0.2987095744451148,...
       -2.6146201473329445, -2.4315227608803371,  0.4492468555801895,...
       -0.5825975638039069,  0.0024091152481619, -0.0908793614566750,...
        0.0310251270439888, -0.0025415628426548];
b2000=[0.0118725171307861,  0.1477131706258137,  0.0834813257093114,...
       0.6599137014434021,  0.0680516618086130,  0.2056975644582296,...
       1.4918339417551207,  0.3232891612201607,  0.0113336667540298,...
       0.3424735985442436,  2.0769105873867950,  0.6621541396169911,...
       0.0398475935424811, -0.0120326243958032,  0.0839673587433891,...
       3.3309734341621686,  2.0729677748383186,  0.5059266326029840,...
      -0.0325258166488220,  0.0265644919076263,  1.6014497732194890,...
       0.6161666794487847, -1.9913875207602947, -1.5500876845238303,...
      -0.8799191720117091,  0.1015518689370360, -0.0470216853054528,...
      -2.7994257154120965,  3.5159322977333956, 10.2656078026672490,...
       5.4476192811129387,  2.1734084242037079,  1.1079785499395909,...
      -0.1965732708177111,  0.0648844582071067,  4.4478571483231457,...
       3.6641414589882118,-10.5199114511468410, -8.4064292803243426,...
      -3.9437412282869984, -1.7784906820961639, -0.8161104954398789,...
       0.2394122578444220, -0.0552579182468893, -3.1069204661153766,...
      -4.5506367620167794,  7.9828080917585664,  9.1038181215613800,...
       3.3383303511897680,  1.7990562949251985,  0.8465619225558672,...
       0.3623224164714963, -0.1449773658955066,  0.0264933443506279,...
       1.1677288756026567,  4.0963629227533662,  0.0301263628948869,...
      -2.3477813538639669, -2.5251926836364276, -0.0310694147451350,...
      -0.5409428343692908, -0.1237935747915165, -0.0769972427989191,...
       0.0352324267135054, -0.0054667842148308];
b3000=[0.0785827635885904,  0.2695551278473896,  0.2382238071652584,...
       1.0328216533370393,  0.1247478915007856,  0.4140162390210347,...
       2.0015284460583023,  0.5108760266785902,  0.0229668651712469,...
       0.4710255345980255,  2.4507597986923821,  0.9595824732835634,...
       0.0912687197370605, -0.0240034498070701,  0.4836291827068407,...
       3.3828221467655655,  2.3058697460666830,  0.6188641682998639,...
      -0.0949060571716785,  0.0495255939652645,  0.5631345594473561,...
       0.2193349421518067, -1.4348177523796932, -1.5055199075437735,...
      -0.9999286994881966,  0.1998449905375284, -0.0808028164411438,...
      -0.5060056249998237,  4.4743121103908896,  8.3948864853180467,...
       5.2860988199539962,  2.3163728323890709,  1.2237869330729148,...
      -0.2969414302782713,  0.1071995711552660,  1.4357200837713233,...
      -0.4131525876537621, -8.0340818810588601, -7.4140709614476386,...
      -4.0771581274065571, -1.9635295248168707, -0.8577369546298485,...
       0.3186249517210864, -0.0891383917028742, -1.0078183826520721,...
      -0.3538133913055781,  5.9431525757315100,  7.5824825760773091,...
       3.5194822652513134,  1.8658194832864889,  0.9880724039275926,...
       0.3608443033516683, -0.1807834054140192,  0.0418809878176974,...
       0.4487343447885416,  1.4512313465086606, -0.3360118727756923,...
      -1.7510557364241466, -2.2962938198371936, -0.3088419704935886,...
      -0.5015613420413067, -0.1810832842851992, -0.0717364475787328,...
       0.0418213839282947,  -0.0084933148202667];
b4000=[0.2025292728310694,  0.4535805178193371,  0.4619529228253870,...
       1.5050223213845073,  0.2071955505767959,  0.6437308550992064,...
       2.5243360744326573,  0.7412658851522664,  0.0423704843675533,...
       0.6140978851799495,  2.7862073290509763,  1.2998138955622245,...
       0.1641947081515549, -0.0449927428457055,  0.6279650013273181,...
       3.1207312076604552,  2.2407723123627745,  0.5974101842363415,...
      -0.1825641579944942,  0.0855909178828273,  0.1844413155784955,...
       0.5223664533265552, -0.3519721696481735, -0.9008619702435032,...
      -0.8448635820898949,  0.3092224003983553, -0.1257086609252269,...
       0.3384673101491614,  3.6348681214896899,  5.3562413927987294,...
       3.6504512985769546,  1.6480236985680801,  1.0007490307016402,...
      -0.3649451095039235,  0.1574038007122379,  0.1857481467182152,...
      -1.4220805549487217, -4.8292551318561738, -4.6970627283560491,...
      -2.9443647298503630, -1.5212482732609338, -0.6594809864833450,...
       0.3448536440626046, -0.1264469788813310, -0.1324725541385111,...
       0.9869763458864849,  3.6542601906524093,  4.8370370795241673,...
       2.5399592178743542,  1.4048963955470359,  0.8468579636180608,...
       0.2684141147143119, -0.1833004462925690,  0.0578087199931896,...
       0.1173135531934554,  0.2527217950051099, -0.5079195041748702,...
      -1.0466273387162957, -1.6395178196376621, -0.3381652791256403,...
      -0.3871687754769886, -0.1831466213460729, -0.0535170370052017,...
       0.0403261430308532, -0.0114729554142256];
b5000=[0.3820086307374105,  0.6807613639619611,  0.7180920672500770,...
       1.9793843471466850,  0.3124949454944219,  0.8433489272703364,...
       2.9250611189905955,  1.0042895177915170,  0.0642414761968527,...
       0.7221376372236928,  2.9668170274813592,  1.6548086286881780,...
       0.2275290990451938, -0.0590145072807306,  0.6090090598891532,...
       2.7374627218706937,  2.0801130054946806,  0.4628016849985791,...
      -0.2343271318404560,  0.0994940210577284,  0.1681432252906211,...
       0.8912020824082482,  0.5479975819471963, -0.1748191031230424,...
      -0.4657776175011719,  0.3404629504354561, -0.1222687660231525,...
       0.3675000299589536,  2.3164749832104210,  2.9563110112297850,...
       1.8627674152533542,  0.6905272676347027,  0.4954414141356421,...
      -0.3089017239367066,  0.1466725239452260, -0.0469903429666572,...
      -0.9965580503457868, -2.5914028295128619, -2.3810575257098692,...
      -1.4495868944669281, -0.8176403208799353, -0.2511400103769822,...
       0.2533189951137676, -0.1161276788157323,  0.0374559531927267,...
       0.7971207608475803,  2.0059253087100357,  2.7952067050958371,...
       1.4339645049242822,  0.7106855454689587,  0.5809337260602813,...
       0.0865651273628418, -0.1249025137207347,  0.0525079242576474,...
       0.0251227182549338, -0.0232741163472784, -0.3864171843725351,...
      -0.6045662972801092, -1.0425898811276679, -0.2605925512215324,...
      -0.2288471328224155, -0.1616192788490930, -0.0193525655071953,...
       0.0253750796226042,  -0.0103837266541834];
 
IC=0;
if (pr==0),        b=b0;       spi0=3.494486289; IC=1; end
if (pr== 500),   b=b500;   spi0=1.720013647; IC=1; end
if (pr==1000),  b=b1000; spi0=1.362343815; IC=1; end
if (pr==2000),  b=b2000; spi0=1.451450857; IC=1; end
if (pr==3000),  b=b3000; spi0=1.765290149; IC=1; end
if (pr==4000),  b=b4000; spi0=2.180009299; IC=1; end
if (pr==5000),  b=b5000; spi0=2.628557566; IC=1; end
if (IC==0), error('Reference pressure incorrect '), end
 
if (SA<10 | SA>40), error('Salinity out of bound'), end
if (CT<-2 | CT>40), error('Temperature out of bound'), end
 
s=(SA-10)/30;
t=(CT+2)/42;
  s2=s.*s;s3=s2.*s;s4=s3.*s;s5=s4.*s;s6=s5.*s;s7=s6.*s;s8=s7.*s;s9=s8.*s;s10=s9.*s;
  t2=t.*t;t3=t2.*t;t4=t3.*t;t5=t4.*t;t6=t5.*t;t7=t6.*t;t8=t7.*t;t9=t8.*t;t10=t9.*t;
sp=b(1).*s+b(2).*t+b(3).*s2+b(4).*s.*t+b(5).*t2;
sp=sp+b(6).*s3+b(7).*s2.*t+b(8).*s.*t2+b(9).*t3;
sp=sp+b(10).*s4+b(11).*s3.*t+b(12).*s2.*t2+b(13).*s.*t3+b(14).*t4;
sp=sp+b(15).*s5+b(16).*s4.*t+b(17).*s3.*t2+b(18).*s2.*t3+b(19).*s.*t4+b(20).*t5;
sp=sp+b(21).*s6+b(22).*s5.*t+b(23).*s4.*t2+...
    b(24).*s3.*t3+b(25).*s2.*t4+b(26).*s.*t5+b(27).*t6;
sp=sp+b(28).*s7+b(29).*s6.*t+b(30).*s5.*t2+...
    b(31).*s4.*t3+b(32).*s3.*t4+b(33).*s2.*t5+b(34).*s.*t6+b(35).*t7;
sp=sp+b(36).*s8+b(37).*s7.*t+b(38).*s6.*t2+...
    b(39).*s5.*t3+b(40).*s4.*t4+b(41).*s3.*t5+b(42).*s2.*t6+b(43).*s.*t7+b(44).*t8;
sp=sp+b(45).*s9+b(46).*s8.*t+b(47).*s7.*t2+b(48).*s6.*t3+b(49).*s5.*t4+...
    b(50).*s4.*t5+b(51).*s3.*t6+b(52).*s2.*t7+b(53).*s.*t8+b(54).*t9;
sp=sp+b(55).*s10+b(56).*s9.*t+b(57).*s8.*t2+b(58).*s7.*t3+b(59).*s6.*t4+...
    b(60).*s5.*t5+b(61).*s4.*t6+b(62).*s3.*t7+b(63).*s2.*t8+b(64).*s.*t9+b(65).*t10;
spi = sp-spi0;
return




